
public aspect AuditAspect {

	Log audit = new Log() ;
	
	pointcut accountOperation() : call (* Account.*(..)) && !call(* Account.toString()) ;
	pointcut accountExecution() : execution (* Account.*(..)) && !execution (* Account.toString(..)) ;
	pointcut marker() : call(@Marker * Account.*(..)) ;
	
	before() : accountOperation() {
		Object target = thisJoinPoint.getTarget();
		audit.store("Before: " + thisJoinPoint + " Target: " + target ) ;
	}
	
	after() : accountExecution() {
		Object target = thisJoinPoint.getTarget();
		audit.store("After: " + thisJoinPoint + " Target: " + target ) ;
	}
	
	Object around(): marker()  {
		System.out.println("Intercepted message: " +
				thisJoinPointStaticPart.getSignature().getName());
		System.out.println("in class: " +
		          thisJoinPointStaticPart.getSignature().getDeclaringType().getName());
		System.out.println("Running original method: \n" );
		Object result = proceed();
		System.out.println("  result: " + result );
		return result;
	}	
		
}
